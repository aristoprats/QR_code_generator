<html lang="en">    

<title> Mass QR Code Generation </title>

<head>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.3/xlsx.full.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>
    

    <script>
        $(document).ready(function(){
              $("#fileUploader").change(function(evt){
                    var selectedFile = evt.target.files[0];
                    var reader = new FileReader();
                    reader.onload = function(event) {
                      var data = event.target.result;
                      var workbook = XLSX.read(data, {
                          type: 'binary'
                      });
                      workbook.SheetNames.forEach(function(sheetName) {
                        
                          let XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
                          let json_object = JSON.stringify(XL_row_object);
                          document.getElementById("jsonObject").innerHTML = json_object;

                        })
                    };

                    reader.onerror = function(event) {
                      console.error("File could not be read! Code " + event.target.error.code);
                    };

                    reader.readAsBinaryString(selectedFile);

              });
        });
    </script>
    <script>
       $(document).ready(function() {

            var qrcode = new QRCode("qr_code", {
                text: "https://cravecookie.com/",
                width: 128,
                height: 128,
                colorDark : "#000000",
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.H
            });

            $("#download").click(
                function() {
                    var pdf = new jsPDF({
                        orientation: "landscape",
                        unit: "mm",
                        format: [84, 40]
                    });

                    pdf.setFontSize(15);
                    pdf.text('CraveCookie', 43, 20);

                    pdf.setFontSize(10);
                    pdf.text('Scan For Menu', 43, 25);

                    let base64Image = $('#qr_code img').attr('src');
                    console.log(base64Image);

                    pdf.addImage(base64Image, 'png', 0, 0, 40, 40);
                    pdf.save('generated.pdf');
                }
            );

        });
    </script>

</head>

<body>

    <input type="file" id="fileUploader" name="fileUploader" accept=".xls, .xlsx"/>
    </br>
    <button id="download"> Process Data </button>
    </br></br>
    <label id="jsonObject"> JSON : </label>

    <div id="qr_code">
    </div>
</body>


