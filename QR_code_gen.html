<html lang="en">    



<head>
    <meta charset="utf-8" />
    <title> Mass QR Code Generation </title>    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.3/xlsx.full.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js" integrity="sha512-NFUcDlm4V+a2sjPX7gREIXgCSFja9cHtKPOL1zj6QhnE0vcY695MODehqkaGYTLyL2wxe/wtr4Z49SvqXq12UQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    


    <script>
        var url_array = [];
        $(document).ready(function(){
              $("#fileUploader").change(function(evt){
                    var starttime = new Date();
                    var selectedFile = evt.target.files[0];
                    var reader = new FileReader();
                    reader.onload = function(event) {
                      var data = event.target.result;
                      var workbook = XLSX.read(data, {
                          type: 'binary'
                      });

                      
                      workbook.SheetNames.forEach(function(sheetName) {
                        
                          var XL_row_object = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
                          var json_object = JSON.stringify(XL_row_object);
                          //document.getElementById("jsonObject").innerHTML = json_object;
                          
                          console.log(typeof XL_row_object);
                          console.log(XL_row_object);

                          XL_row_object.forEach(function(item, index) {
                            console.log(item.AssetLocation, index)
                            url_array.push(item.AssetLocation);
                          })






                          /*
                          url_array.forEach(function(item, index) {
                               
                            new QRCode(document.getElementById(`qrcode-target`),{
                                text : item,
                                widght : 256,
                                height : 256,
                                colorDark : "#000000",
                                colorLight : "#ffffff",
                                correctLevel: QRCode.CorrectLevel.H
                            });
                            */

                            
                            
                          })
                          console.log('Execution time was ');
                          console.log(new Date() - starttime);
     
                        })

                    };
                    

                    reader.onerror = function(event) {
                      console.error("File could not be read! Code " + event.target.error.code);
                    };

                    reader.readAsBinaryString(selectedFile);

                    
                    
              });
        });

    </script>
    
    <script>

    </script>

</head>

<body>

    <input type="file" id="fileUploader" name="fileUploader" accept=".xls, .xlsx"/>
    </br>

    </br></br>

    <div id='qrcode-target'></div>
    <script>
        jQuery(function() {
            jQuery('#qrcode-target').qrcode('http://google.com');        
            var canvas = $('#qrcode-target');
            console.log(canvas);
            var img = canvas.get(0).toDataURL("image/png");
            document.write('<img src="'+img+'"/>')
        });
    

    </script>




</body>


